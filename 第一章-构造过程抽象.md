
### 编程的环境
- 编程语言必须提供为对象命名的机制,这是最基本的抽象机制 Scheme 把名字标识符称为变量,其值就是与之关联的对象, 在 Scheme 中:
    * 用 define 为对象值命名(给名字关联一个值),并可以通过名字索引该对象.
    * 可以用任意复杂的表达式描述要求关联于变量的值.
    * <pre>> (define size 10)
> size
10
> (define num (* size 20))
> num
200 </pre>

- <b>复杂程序通常就是为了计算(构造)出很不容易得到的对象,通过多步构造和命名,分解构造过程,使之比较容易进行,而建立名字-对象关联是其中最重要的抽象手段.</b>
- 构造的值可以存入变量供以后使用,说明 Scheme 解释器有存储能力。 这种存储称为“环境”
    +   define 建立或修改环境中的名字-值关联
    +   表达式在当前环境求值,变量(名)的值由环境获得   Scheme 全局环境预先定义了一批名字-对象关联
    +   有一批预定义的对象,主要是预定义运算和各种过程

### 组合式求值

- 要求求值的通常是组合式,解释器的工作方式是:
  + 求值该组合式的各个子表达式
  + 将最左子表达式的值(运算符的值,应该是一个过程)作用于相应 的实际参数(由其他子表达式求出的值)

- 上述规则说明计算过程的一些情况:
  + <b>组合式求值要求先求值子表达式。 因此求值过程是递归的</b>
  + <b>求值过程可以用树表示,先取得终 端(叶)结点的值后向上累积,最终在树根得到整个表达式的值
  + 树具有递归结构,递归处理很自然</b>

- <b>组合式求值的递归终将到达<code>基本表达式</code></b>,其值直接得到:
  + 数的值是其自身(它们所表示的数值)
  + 内部运算符等的值是系统实现相关运算的指令序列
  + 其他名字的值由当前环境取得,找到相应名字-值关联时取出对应的值,找不到就是错误

- 把运算符(如 +)和其他预定义对象(如 define)都看作名字,在环境 中查找关联的“值”,统一后两种情况
    - 环境为程序里用的名字提供定义
    - 求值中遇到在当时环境里无定义的名字时报错

- 求值规则有例外。如 (define x 1) 里的 x 不应该求值,是要求为名字 x
关联一个新值。说明 define 有特殊求值规则 
    + 有特殊求值规则的名字称为特殊形式(special form)。每个特殊形
式有自己的求值规则。Scheme 有一组特殊形式,如 define

### 过程定义

- 表达式可能变得很长,编程中经常出现重复或类似的表达式 为控制程序复杂性,必须有抽象机制,Scheme 用“过程定义”来解决这个问题
- 求平方过程的定义:<code>(define (square x) (* x x))</code> 包括:过程名,形式参数,做什么(如何求值) ; 求值这种定义表达式,将相应计算过程关联于名字(这里的square)
- 定义好的过程就像基本操作,可以通过名字使用
- <b>预定义基本过程(操作)和特殊形式是构造程序的基本构件</b>
- <b>过程定义是分解和控制程序复杂性的最重要技术之一</b>

### 过程应用的代换模型(简化模型)
- 组合式和复合过程确定的计算过程是(代换模型):
    1. 求出各参数表达式(子表达式)的值
    2. 找到要调用的过程的定义(根据第一个子表达式的求值结果)
    3. 用求出的实际参数代换过程体里的形式参数
    4. 求值过程体
- 代换模型给出了过程定义和过程应用的一种语义
    + 很多 Scheme 过程的行为可以用这个模型描述, 后面会看到,更复杂的过程需要用扩充的语义模型
    + 代换模型只是为了帮助直观理解过程应用的行为,它并没有反映解释器的实际工作过程,实际解释器的情况,基于环境实现
    + 代换模型最简单,容易理解,但不足以解释所有的实际程序,其局限性是不能解释带有可变数据的程序

### 应用序和正则序求值
- 应用序求值: 解释器先求值子表达式(运算符和各运算对象),而后把得到的运算应用于运算对象(实际参数).
- 正则序求值:是先不求值运算对象,推迟到需要时再求值。
- Scheme 采用应用序求值

### 条件表达式和谓词
- 复杂计算的描述中总需要描述条件和选择
- Scheme 的条件表达式:
    + 
    <pre>(cond (\<p1> \<e1>)
            (\<p2> \<e2>)
     </pre>
     在这里,运算符 cond 后面跟着多个括起来的子语句,各个子语句都是一个表达式对偶,每个表达式中有两个字表达式,其中第一个表达式成为<code>谓词</code>,即是这个表达式可以被解释为真假.
    + 依次求值各个 p(条件),遇到第一个非 ; false的条件后求值对应的 e,以其值
; 作为整个cond 表达式的值,如果不存在真的表达式,则此 cond 的值就没有定义
    + 绝对值函数还可定义为:
<pre>(define (abs x) (cond ((< x 0) (- x))
                        (else x)))</pre>else 表示永远成立的条件,只应放在最后
- 简化的条件表达式形式:
    + (if \<predicate> \<consequent> \<alternative>) cond 和 if 都是特殊形式,有特殊的求值规则.

- 逻辑组合运算符 and 和 or 也是特殊形式,采用特殊求值方式 
    + <b>(and \<e1> ... \<en>)</b>
    + 逐个求值 e,直到某个 e 求出假,或最后一个 e 求值完成。以最后求 值的那个子表达式的值作为值
    + <b>(or \<e1> ... \<en>)</b>
    + 逐个求值 e,直到某个 e 求出真,或最后的 e 求值完成。以最后求值的那个子表达式的值作为值
    + <b>(not \<e>) </b>
    + 如果 e 的值不是真,就得真,否则得假
- 求出真假值的过程称为谓词。各种关系运算符是基本谓词,可以用 and、or、not 组合出各种复杂逻辑条件,可以用过程定义谓词.
- 过程很像数学函数,但它必须了描述一种有效的计算方法

### 函数和过程
- 函数和过程之间的矛盾,不过是描述一件事情特征(是什么),与描述如何做这件事情之间的普遍性差异的反映.也可以说是说明新知识和行动性知识之间的差异.
- 在数学里,通常关心的是如何是描述一件事,而在计算机科学中,关心的通常是如何解决一件事.

### 表达式的一些情况
- 如果一个变量没定义,对它求值是错误,求值中断 如果变量有定义,求值得到它当时的关联值
- 对内部过程名求值得到某种特殊信息。如(不同系统可能不同) <code>> +</code> 得到<code> #\<procedure:+></code>
- 对自己定义的过程名求值也得到特殊信息。如<code> > (define (square x) (* x x))</code><code> square</code> 得到 <code>#\<procedure:square></code>
- 特殊形式的名字不能求值 例如,对 define 求值将出错

### 基本类型和表达式
- 数值类型:整形/实数/其他数值类型
  - 数值类型的运算:基本算术运算/逻辑判断/常用函数/随机数生成
- 布尔类型
- 字符类型
  - 字符类型操作:比较/数值字符转换/其他操作(大小写转换)
- 字符串类型
  - 字符串的运算:常用的字符串操作(取长度,取子串)/比较/模式匹配/其他(拼接等)
- 其他类型(组合类型等)


